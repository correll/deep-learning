#!/usr/bin/python
# Author: Kaunil N. Dhruv <dhruv.kaunil@gmail.com> * <kaunil.dhruv@colorado.edu>
import math

class AbsorptionCoefficients:
    def __init__(self):
        self.coefficients = {
            "oxy": {
                "600": 1.02419, "601": 0.9653859, "602": 0.9093505, "603": 0.856014, "604": 0.8053063, "605": 0.7571575, "606": 0.7114978, "607": 0.6682571, "608": 0.6273656, "609": 0.5887534, "610": 0.5523506, "611": 0.5180872, "612": 0.4858932, "613": 0.4556989, "614": 0.4274343, "615": 0.4010295, "616": 0.3764144, "617": 0.3535194, "618": 0.3322743, "619": 0.3126094, "620": 0.2944546, "621": 0.2777401, "622": 0.2623959, "623": 0.2483522, "624": 0.235539, "625": 0.2238864, "626": 0.2133245, "627": 0.2037833, "628": 0.195193, "629": 0.1874836, "630": 0.1805853, "631": 0.174428, "632": 0.168942, "633": 0.1640572, "634": 0.1597037, "635": 0.1558117, "636": 0.1523112, "637": 0.1491323, "638": 0.1462051, "639": 0.1434597, "640": 0.1408261, "641": 0.1382457, "642": 0.1357048, "643": 0.1332011, "644": 0.130732, "645": 0.1282952, "646": 0.1258882, "647": 0.1235087, "648": 0.1211543, "649": 0.1188224, "650": 0.1165108, "651": 0.11424, "652": 0.1121224, "653": 0.1102938, "654": 0.1088445, "655": 0.1076841, "656": 0.1066773, "657": 0.1056887, "658": 0.1046193, "659": 0.1035167, "660": 0.102465, "661": 0.1015376, "662": 0.1007638, "663": 0.1001625, "664": 0.09973894, "665": 0.09944611, "666": 0.09922363, "667": 0.09901116, "668": 0.0987665, "669": 0.09852006, "670": 0.09832038, "671": 0.09820242, "672": 0.09814675, "673": 0.09812033, "674": 0.09809012, "675": 0.09803102, "676": 0.09794947, "677": 0.09785987, "678": 0.09777175, "679": 0.09767535, "680": 0.09755608, "681": 0.09739935, "682": 0.09719613, "683": 0.09695962, "684": 0.09670857, "685": 0.09646034, "686": 0.09622665, "687": 0.0960178, "688": 0.09584286, "689": 0.0957059, "690": 0.09560976, "691": 0.09555728, "692": 0.09554637, "693": 0.09555526, "694": 0.09555728, "695": 0.09553864, "696": 0.09553707, "697": 0.09560316, "698": 0.09578754, "699": 0.09611793, "700": 0.09653058, "701": 0.09693883, "702": 0.0972799, "703": 0.09758628, "704": 0.09791433, "705": 0.09832038, "706": 0.09884569, "707": 0.09947113, "708": 0.1001625, "709": 0.1008834, "710": 0.1015897, "711": 0.1022348, "712": 0.1027921, "713": 0.1033138, "714": 0.1038716, "715": 0.1045374, "716": 0.1053607, "717": 0.1063023, "718": 0.1073005, "719": 0.1082953, "720": 0.1092336, "721": 0.1100636, "722": 0.110758, "723": 0.1113869, "724": 0.112045, "725": 0.1128267, "726": 0.113788, "727": 0.1148312, "728": 0.11582, "729": 0.1166578, "730": 0.1174066, "731": 0.118168, "732": 0.1190436, "733": 0.1201028, "734": 0.1212851, "735": 0.1224975, "736": 0.1236597, "737": 0.1247405, "738": 0.1257211, "739": 0.126597, "740": 0.1274204, "741": 0.1282576, "742": 0.129175, "743": 0.1302227, "744": 0.1313847, "745": 0.1326289, "746": 0.1339149, "747": 0.1351699, "748": 0.136313, "749": 0.1372922, "750": 0.1381711, "751": 0.1390419, "752": 0.1399972, "753": 0.1411066, "754": 0.1423492, "755": 0.1436813, "756": 0.1450526, "757": 0.1463854, "758": 0.1475957, "759": 0.1486301, "760": 0.1495594, "761": 0.1504855, "762": 0.1515101, "763": 0.1527066, "764": 0.1540344, "765": 0.1554245, "766": 0.15681, "767": 0.1581333, "768": 0.1593389, "769": 0.1603964, "770": 0.1613761, "771": 0.1623733, "772": 0.1634835, "773": 0.1647719, "774": 0.1661822, "775": 0.1676282, "776": 0.1690319, "777": 0.1703487, "778": 0.1715426, "779": 0.1725979, "780": 0.1735819, "781": 0.1745824, "782": 0.1756872, "783": 0.1769593, "784": 0.1783615, "785": 0.1798319, "786": 0.1813063, "787": 0.1827126, "788": 0.1839765, "789": 0.1850552, "790": 0.1860302, "791": 0.1870145, "792": 0.1881212, "793": 0.1894246, "794": 0.1908455, "795": 0.1922659, "796": 0.1935988, "797": 0.1948811, "798": 0.1961802, "799": 0.1975357, "800": 0.1988742, "801": 0.2000946, "802": 0.2011306, "803": 0.2020559, "804": 0.2029791, "805": 0.204009, "806": 0.2052209, "807": 0.2065563, "808": 0.2079234, "809": 0.2092505, "810": 0.2105459, "811": 0.2118378, "812": 0.2131379, "813": 0.2143901, "814": 0.215522, "815": 0.2164891, "816": 0.2173605, "817": 0.2182337, "818": 0.2192061, "819": 0.2203455, "820": 0.2216005, "821": 0.2228902, "822": 0.2241406, "823": 0.2253051, "824": 0.2263441, "825": 0.2272391, "826": 0.2280554, "827": 0.2288796, "828": 0.229798, "829": 0.23087, "830": 0.2320466, "831": 0.2332519, "832": 0.2344255, "833": 0.2355705, "834": 0.2367057, "835": 0.2378472, "836": 0.2389983, "837": 0.2401596, "838": 0.2413196, "839": 0.2424182, "840": 0.2433832, "841": 0.2441724, "842": 0.2448628, "843": 0.2455619, "844": 0.2463766, "845": 0.2473777, "846": 0.2484896, "847": 0.2496002, "848": 0.2506268, "849": 0.2516034, "850": 0.2525936, "851": 0.253635, "852": 0.2546629, "853": 0.2555869, "854": 0.2563466, "855": 0.2570009, "856": 0.2576391, "857": 0.25835, "858": 0.2591971, "859": 0.2601401, "860": 0.2611131, "861": 0.2620623, "862": 0.2629814, "863": 0.2638763, "864": 0.2647503, "865": 0.2655974, "866": 0.2664091, "867": 0.2671829, "868": 0.267941, "869": 0.2687117, "870": 0.2695095, "871": 0.2702948, "872": 0.2710143, "873": 0.2716325, "874": 0.2721861, "875": 0.2727294, "876": 0.2733169, "877": 0.2739844, "878": 0.2746941, "879": 0.2753892, "880": 0.2760284, "881": 0.276631, "882": 0.2772312, "883": 0.277853, "884": 0.2784769, "885": 0.2790733, "886": 0.2796228, "887": 0.2801488, "888": 0.2806851, "889": 0.281251, "890": 0.2818066, "891": 0.2822969, "892": 0.2826856, "893": 0.2830091, "894": 0.2833218, "895": 0.2836785, "896": 0.2841152, "897": 0.2845944, "898": 0.28506, "899": 0.2854707, "900": 0.2858437, "901": 0.2862113, "902": 0.2865966, "903": 0.2869874, "904": 0.2873626, "905": 0.2877048, "906": 0.2880115, "907": 0.2882837, "908": 0.2885251, "909": 0.2887498, "910": 0.2889744, "911": 0.28921, "912": 0.2894458, "913": 0.2896652, "914": 0.2898543, "915": 0.2900086, "916": 0.2901257, "917": 0.2902064, "918": 0.2902621, "919": 0.2903072, "920": 0.290356, "921": 0.2904198, "922": 0.2904979, "923": 0.2905862, "924": 0.2906789, "925": 0.2907612, "926": 0.2908165, "927": 0.2908342, "928": 0.2908276, "929": 0.2908165, "930": 0.2908153, "931": 0.2908187, "932": 0.2908165, "933": 0.2907952, "934": 0.2907283, "935": 0.2905862, "936": 0.2903572, "937": 0.290101, "938": 0.2898955, "939": 0.2897927, "940": 0.2897416, "941": 0.2896652, "942": 0.2895037, "943": 0.2892651, "944": 0.2889744, "945": 0.2886572, "946": 0.2883408, "947": 0.2880534, "948": 0.2878125, "949": 0.2875938, "950": 0.2873626, "951": 0.2870914, "952": 0.2867815, "953": 0.2864416, "954": 0.2860788, "955": 0.2856949, "956": 0.2852903, "957": 0.2848636, "958": 0.2844065, "959": 0.2839087, "960": 0.2833686, "961": 0.282818, "962": 0.2822969, "963": 0.2818309, "964": 0.2813865, "965": 0.2809154, "966": 0.2803858, "967": 0.2798317, "968": 0.2793036, "969": 0.2788362, "970": 0.2784022, "971": 0.2779583, "972": 0.2774615, "973": 0.2768834, "974": 0.2762543, "975": 0.2756194, "976": 0.2750107, "977": 0.2744079, "978": 0.2737774, "979": 0.2730977, "980": 0.2723944, "981": 0.271705, "982": 0.2710414, "983": 0.2703127, "984": 0.2694025, "985": 0.2682602, "986": 0.2670999, "987": 0.266137, "988": 0.2653285, "989": 0.264567, "990": 0.2637651, "991": 0.2629163, "992": 0.2620342, "993": 0.2611304, "994": 0.2602088, "995": 0.2592711, "996": 0.2583239, "997": 0.2573927, "998": 0.256508, "999": 0.2556829
            },
            "dxy": {
                "600": 3.170199, "601": 3.008515, "602": 2.854807, "603": 2.70887, "604": 2.570499, "605": 2.43949, "606": 2.315637, "607": 2.198736, "608": 2.088583, "609": 1.984973, "610": 1.887701, "611": 1.796562, "612": 1.711352, "613": 1.631866, "614": 1.5579, "615": 1.489248, "616": 1.425706, "617": 1.36707, "618": 1.313134, "619": 1.263694, "620": 1.218545, "621": 1.177483, "622": 1.140303, "623": 1.1068, "624": 1.07677, "625": 1.050007, "626": 1.026308, "627": 1.005467, "628": 0.9872797, "629": 0.9715416, "630": 0.9580481, "631": 0.9465942, "632": 0.9369755, "633": 0.9289871, "634": 0.9224243, "635": 0.9170827, "636": 0.9127573, "637": 0.9092436, "638": 0.9063368, "639": 0.9038323, "640": 0.9015254, "641": 0.899229, "642": 0.8968261, "643": 0.8942176, "644": 0.8913041, "645": 0.8879863, "646": 0.8841649, "647": 0.8797407, "648": 0.8746142, "649": 0.8686863, "650": 0.8618576, "651": 0.8541802, "652": 0.846312, "653": 0.839062, "654": 0.8329906, "655": 0.8276622, "656": 0.8223924, "657": 0.8164967, "658": 0.8094514, "659": 0.8013758, "660": 0.7925498, "661": 0.7833078, "662": 0.7742021, "663": 0.7658398, "664": 0.758566, "665": 0.7516793, "666": 0.7442168, "667": 0.7352154, "668": 0.7241318, "669": 0.7121007, "670": 0.7006766, "671": 0.6909574, "672": 0.6822143, "673": 0.6732617, "674": 0.6629142, "675": 0.6504695, "676": 0.6371576, "677": 0.6246913, "678": 0.6143092, "679": 0.6053502, "680": 0.5966787, "681": 0.5871592, "682": 0.5759753, "683": 0.5635882, "684": 0.5507784, "685": 0.5382837, "686": 0.5266723, "687": 0.5164698, "688": 0.5079694, "689": 0.5005345, "690": 0.493296, "691": 0.4853849, "692": 0.4762763, "693": 0.4668211, "694": 0.4582144, "695": 0.4513128, "696": 0.4456175, "697": 0.4402916, "698": 0.4344978, "699": 0.4276977, "700": 0.4205482, "701": 0.4140048, "702": 0.4087583, "703": 0.4044391, "704": 0.4004127, "705": 0.3960446, "706": 0.3908741, "707": 0.3851352, "708": 0.3792358, "709": 0.3735437, "710": 0.3682681, "711": 0.3635782, "712": 0.3595544, "713": 0.3559224, "714": 0.352319, "715": 0.3483811, "716": 0.3438548, "717": 0.3389222, "718": 0.3338748, "719": 0.3289879, "720": 0.3244715, "721": 0.3205198, "722": 0.3172487, "723": 0.3144612, "724": 0.3118824, "725": 0.3092372, "726": 0.3063541, "727": 0.3034757, "728": 0.3009479, "729": 0.2990362, "730": 0.2976843, "731": 0.2967553, "732": 0.2961124, "733": 0.2956774, "734": 0.2956059, "735": 0.2961124, "736": 0.2973262, "737": 0.2990366, "738": 0.3009479, "739": 0.302857, "740": 0.3049317, "741": 0.3074322, "742": 0.3106187, "743": 0.3146859, "744": 0.3195659, "745": 0.325125, "746": 0.3311757, "747": 0.3373149, "748": 0.3430852, "749": 0.3481716, "750": 0.3528272, "751": 0.3574473, "752": 0.3624269, "753": 0.3679787, "754": 0.3735849, "755": 0.378545, "756": 0.3823005, "757": 0.38486, "758": 0.3863738, "759": 0.3869494, "760": 0.3865221, "761": 0.3849846, "762": 0.3822291, "763": 0.3781679, "764": 0.3727918, "765": 0.366111, "766": 0.3582691, "767": 0.3499408, "768": 0.3419339, "769": 0.3348222, "770": 0.3282437, "771": 0.3216026, "772": 0.3143029, "773": 0.3059461, "774": 0.2969233, "775": 0.2878231, "776": 0.2791832, "777": 0.2713369, "778": 0.264567, "779": 0.2590241, "780": 0.2543307, "781": 0.2499777, "782": 0.2454556, "783": 0.2404124, "784": 0.2351252, "785": 0.2300283, "786": 0.2254842, "787": 0.2215686, "788": 0.2182851, "789": 0.2155987, "790": 0.2133202, "791": 0.2112215, "792": 0.2090747, "793": 0.2067211, "794": 0.2042792, "795": 0.2019367, "796": 0.199837, "797": 0.1979448, "798": 0.1961802, "799": 0.1944903, "800": 0.1929286, "801": 0.1915751, "802": 0.1904795, "803": 0.1895692, "804": 0.1887407, "805": 0.1878909, "806": 0.1869516, "807": 0.1859948, "808": 0.1851278, "809": 0.1844263, "810": 0.1838397, "811": 0.1832858, "812": 0.1827074, "813": 0.1821475, "814": 0.181674, "815": 0.1813353, "816": 0.1811017, "817": 0.180924, "818": 0.1807529, "819": 0.1805495, "820": 0.1803153, "821": 0.1800622, "822": 0.1798044, "823": 0.1795654, "824": 0.1793714, "825": 0.1792415, "826": 0.1791689, "827": 0.1791399, "828": 0.1791411, "829": 0.1791571, "830": 0.1791653, "831": 0.1791411, "832": 0.1790706, "833": 0.1789812, "834": 0.1789109, "835": 0.178887, "836": 0.1788953, "837": 0.1789109, "838": 0.1789148, "839": 0.1789114, "840": 0.1789109, "841": 0.1789233, "842": 0.1789589, "843": 0.1790281, "844": 0.1791411, "845": 0.1792992, "846": 0.1794674, "847": 0.1796016, "848": 0.1796753, "849": 0.1797317, "850": 0.1798319, "851": 0.1800188, "852": 0.1802644, "853": 0.1805227, "854": 0.1807585, "855": 0.1809788, "856": 0.1812013, "857": 0.1814437, "858": 0.1817199, "859": 0.1820286, "860": 0.1823647, "861": 0.1827244, "862": 0.1831078, "863": 0.183516, "864": 0.1839503, "865": 0.1844108, "866": 0.1848976, "867": 0.1854106, "868": 0.1859484, "869": 0.1865094, "870": 0.1870849, "871": 0.1876371, "872": 0.1881212, "873": 0.1885119, "874": 0.1888623, "875": 0.1892451, "876": 0.189733, "877": 0.190371, "878": 0.191093, "879": 0.1918053, "880": 0.1924403, "881": 0.1930337, "882": 0.1936474, "883": 0.1943245, "884": 0.1950324, "885": 0.1957197, "886": 0.1963505, "887": 0.1969508, "888": 0.1975618, "889": 0.1982076, "890": 0.1988427, "891": 0.1994039, "892": 0.1998496, "893": 0.2002235, "894": 0.2005905, "895": 0.2010157, "896": 0.2015395, "897": 0.2021042, "898": 0.2026275, "899": 0.2030513, "900": 0.2034142, "901": 0.2037788, "902": 0.2041863, "903": 0.2045922, "904": 0.2049301, "905": 0.205153, "906": 0.2052904, "907": 0.2053906, "908": 0.2054899, "909": 0.2055751, "910": 0.2056208, "911": 0.2056063, "912": 0.2055289, "913": 0.2053906, "914": 0.2051958, "915": 0.2049597, "916": 0.2046998, "917": 0.2044267, "918": 0.2041223, "919": 0.2037612, "920": 0.2033183, "921": 0.2027767, "922": 0.202154, "923": 0.2014762, "924": 0.2007619, "925": 0.2000003, "926": 0.1991736, "927": 0.1982658, "928": 0.1972697, "929": 0.1961802, "930": 0.1949996, "931": 0.1937588, "932": 0.1924961, "933": 0.1912358, "934": 0.1899462, "935": 0.1885817, "936": 0.1871114, "937": 0.1855624, "938": 0.1839765, "939": 0.1823855, "940": 0.1807801, "941": 0.1791411, "942": 0.1774498, "943": 0.1756898, "944": 0.1738452, "945": 0.1719081, "946": 0.1699021, "947": 0.1678585, "948": 0.1658022, "949": 0.1637323, "950": 0.1616415, "951": 0.1595233, "952": 0.1573748, "953": 0.1551942, "954": 0.1529824, "955": 0.1507516, "956": 0.1485167, "957": 0.1462892, "958": 0.1440657, "959": 0.1418392, "960": 0.1396062, "961": 0.1373761, "962": 0.1351617, "963": 0.1329664, "964": 0.1307553, "965": 0.1284842, "966": 0.1261437, "967": 0.1238631, "968": 0.1218068, "969": 0.1200804, "970": 0.1185553, "971": 0.1170441, "972": 0.1153595, "973": 0.1133706, "974": 0.1111714, "975": 0.1089123, "976": 0.1067135, "977": 0.1045747, "978": 0.102465, "979": 0.1003715, "980": 0.09835104, "981": 0.09647832, "982": 0.09476232, "983": 0.09294979, "984": 0.09072185, "985": 0.08794108, "986": 0.08519565, "987": 0.08307116, "988": 0.08141728, "989": 0.0798997, "990": 0.07825865, "991": 0.07653246, "992": 0.07483402, "993": 0.07324638, "994": 0.07173333, "995": 0.07022885, "996": 0.06868605, "997": 0.06713469, "998": 0.06562368, "999": 0.06418923
            }
        }

    def get_coefficient(self, wav, hb_type):
        l_wav = math.floor(wav)
        u_wav = l_wav + 1

        l_coef = self.coefficients[hb_type][str(l_wav)]
        u_coef = self.coefficients[hb_type][str(u_wav)]

        e = (u_coef - l_coef)/(u_wav - l_wav)*(wav-l_wav)+l_coef
        return e
